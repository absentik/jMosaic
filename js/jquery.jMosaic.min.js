/*
 * jQuery jMosaic plugin 0.0.7 
 * 
 * Author: Seleznev Alexander (ABSENT) 
 * Email: absenteg@gmail.com 
 * Website: http://whoisabsent.ru 
 *  
 * Licensed under the MIT license. 
 * http://www.opensource.org/licenses/mit-license.php 
 */

(function(b){function n(a,d,j,c){var l=a.find(d).outerHeight(!0),g=a.width()-1,h=0,f=0,e=0,h=l/c*g;a.find(d).each(function(){b(this).width(p(b(this),h-2*j));f+=b(this).outerWidth(!0)});a.find(d).height(h-2*j);e=a.find(d).last().outerWidth(!0)+(g-f)-2*j;a.find(d).last().width(e)}function p(a,b){var j="undefined"!=typeof a.attr("width")?a.attr("width"):a.width(),c="undefined"!=typeof a.attr("height")?a.attr("height"):a.height();return Math.round(b*(j/c))}var k={init:function(a){var d=b.extend({items_type:"img",
min_row_height:150,margin:0,is_first_big:!1},a);return this.each(function(){var a=b(this),c=d.items_type,l=d.min_row_height,g=d.margin,h=d.is_first_big,f=0,e=0,k=a.find(c).length;if(h){var m=a.find(c),m=b.makeArray(m);m.reverse();b(a).html(m)}a.addClass("jMosaic-selector");a.find(c).each(function(c){b(this).addClass("jMosaic-item");var d=p(b(this),l);b(this).removeAttr("width").removeAttr("height").css({width:d+"px",height:l+"px",margin:g+"px"});0==c?(e+=b(this).outerWidth(!0),f++):b(this).position().top!=
b(this).prev().position().top?(n(a,".jMosaic-row_"+f,g,e),e=b(this).outerWidth(!0),f++):e+=b(this).outerWidth(!0);b(this).addClass("jMosaic-row_"+f);c==k-1&&n(a,".jMosaic-row_"+f,g,e)});h&&(c=a.find(c),c=b.makeArray(c),c.reverse(),b(a).html(c));a.append("<div style='clear:both;'></div>")})},clear:function(){return this.each(function(){var a=b(this);a.find(".jMosaic-item").each(function(){b(this)[0].className=b(this)[0].className.replace(/\bjMosaic-row_.*?\b/g,"")});a.find(".jMosaic-item").removeClass("jMosaic-item");
a.removeClass("jMosaic-selector")})}};b.fn.jMosaic=function(a){if(k[a])return k[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return k.init.apply(this,arguments);b.error('Method "'+a+'" does not exist on jMosaic.')}})(jQuery);
